# MarketResearcher Fail2Ban configuration

# SSH protection
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

# Nginx HTTP authentication failures
[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 3
bantime = 3600
findtime = 600

# Nginx bad bots and scanners
[nginx-badbots]
enabled = true
filter = nginx-badbots
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 86400
findtime = 3600

# Protect MarketResearcher API (FastAPI)
[marketresearcher-api]
enabled = true
port = 8000
filter = marketresearcher-api
logpath = ./web/logs/api_access.log
maxretry = 5
bantime = 3600
findtime = 600

# Protect MarketResearcher Streamlit UI
[marketresearcher-ui]
enabled = true
port = 8501
filter = marketresearcher-ui
logpath = ./web/logs/streamlit_access.log
maxretry = 5
bantime = 3600
findtime = 600
